$FolderPath="C:\Windows\SoftwareDistribution"
$DirectoryName = (Get-Date).tostring("MM-dd-yyyy HH")
taskkill /F /FI "SERVICES eq wuauserv";
taskkill /F /IM WinStore.App.exe;
net stop cryptSvc;
net stop bits;
net stop msiserver;
net stop wuauserv;
Rename-Item -Force -Path $FolderPath -newName ("SoftwareDistribution.bak "+ $DirectoryName);
Remove-Item -Force -ErrorAction SilentlyContinue -Recurse "C:\Windows\SoftwareDistribution\Download";
New-Item -ItemType Directory -Force C:\Windows\SoftwareDistribution\DataStore;
net stop appidsvc;
net start bits;
net start wuauserv;
net start cryptSvc;
net start wuauserv;
Write-Host "Done";
Write-Host "Restarting the system in 30 seconds!";
Start-Sleep -Seconds 30;
Restart-Computer
# SIG # Begin signature block
# MIISBQYJKoZIhvcNAQcCoIIR9jCCEfICAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB
# gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR
# AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQUIYzupRYdFP4GKZTkNXDqUWfW
# MoGggg1dMIIDIjCCAgqgAwIBAgIQR9M7OFsrlbZJR6bTyYojUDANBgkqhkiG9w0B
# AQsFADApMScwJQYJKoZIhvcNAQkBFhhjaHJpcy5jYW1wYmVsbEBsaW51eC5jb20w
# HhcNMjEwODE1MDA1MTM1WhcNMjIwODE1MDExMTM1WjApMScwJQYJKoZIhvcNAQkB
# FhhjaHJpcy5jYW1wYmVsbEBsaW51eC5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IB
# DwAwggEKAoIBAQDRqEiQo/pb0Zq5tJQOwFOZaNYehAu/O9wB7j8v3OiToTrwMOri
# tt1Q3uZ1b/E6FStV0Rp3ykuvP8DUy/sGDY2dXXhyX+kZGmRAlheNhvqmdpx4NqJe
# 5k7dkOeJt8x5h6UIwpM52EuVwgS6I6MI0igvMKq2lg42fzvZVy+fIa82j0LoQAU2
# Q1X+YTZqmMfBPtzDI4LmGW3qKSKzwHea7uNp/jtEQs4xo1ZTZlsbhm+X0vaoGmVV
# FhrG6XcJWlvFd7fg2Ug6RE/DeZONCxRkSpueJQ5MfCaarnrHVLhS4hLq9TWwAnuZ
# stDdupENcCE8JB6eWvkUKJ1sn82IQ1IiZEetAgMBAAGjRjBEMA4GA1UdDwEB/wQE
# AwIHgDATBgNVHSUEDDAKBggrBgEFBQcDAzAdBgNVHQ4EFgQU1PvRMxyqjqqSvOgA
# fij7xgfhlZowDQYJKoZIhvcNAQELBQADggEBAGXYwDCvsN2p9UlGJ9XVd+J8pmGx
# UFfUP+Bz0f4nGzOQuJVoeXMmOiZd1CLRuvHUpO2daiQWgc/4wgEcr4nizqr1cjUN
# Uem2hCYtjN8dwRKBrgY3w64IOlrDSM8SSrC80o8DxqgoICgK3Lo0cwHH9LAxk7y7
# aq+wl1ECGy7Z6VXDPW80J/4nL5O9qVfBx5zrqSKcMuKvYhVPG+2dooMAkfYUT8l9
# a/AHjU8AjQzwyvsMDWO/kDsAtBbwsT84plF1Ygyphw7BRD+gaQpEGajyFOYg69Nh
# CGLGyLoru9TBv+EIMatIbf5cMLp0Ns08mfBLZ3GskZXRy+NtoWAFDrmTeeYwggT+
# MIID5qADAgECAhANQkrgvjqI/2BAIc4UAPDdMA0GCSqGSIb3DQEBCwUAMHIxCzAJ
# BgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5k
# aWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNIQTIgQXNzdXJlZCBJRCBU
# aW1lc3RhbXBpbmcgQ0EwHhcNMjEwMTAxMDAwMDAwWhcNMzEwMTA2MDAwMDAwWjBI
# MQswCQYDVQQGEwJVUzEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4xIDAeBgNVBAMT
# F0RpZ2lDZXJ0IFRpbWVzdGFtcCAyMDIxMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
# MIIBCgKCAQEAwuZhhGfFivUNCKRFymNrUdc6EUK9CnV1TZS0DFC1JhD+HchvkWsM
# lucaXEjvROW/m2HNFZFiWrj/ZwucY/02aoH6KfjdK3CF3gIY83htvH35x20JPb5q
# dofpir34hF0edsnkxnZ2OlPR0dNaNo/Go+EvGzq3YdZz7E5tM4p8XUUtS7FQ5kE6
# N1aG3JMjjfdQJehk5t3Tjy9XtYcg6w6OLNUj2vRNeEbjA4MxKUpcDDGKSoyIxfcw
# WvkUrxVfbENJCf0mI1P2jWPoGqtbsR0wwptpgrTb/FZUvB+hh6u+elsKIC9LCcmV
# p42y+tZji06lchzun3oBc/gZ1v4NSYS9AQIDAQABo4IBuDCCAbQwDgYDVR0PAQH/
# BAQDAgeAMAwGA1UdEwEB/wQCMAAwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwgwQQYD
# VR0gBDowODA2BglghkgBhv1sBwEwKTAnBggrBgEFBQcCARYbaHR0cDovL3d3dy5k
# aWdpY2VydC5jb20vQ1BTMB8GA1UdIwQYMBaAFPS24SAd/imu0uRhpbKiJbLIFzVu
# MB0GA1UdDgQWBBQ2RIaOpLqwZr68KC0dRDbd42p6vDBxBgNVHR8EajBoMDKgMKAu
# hixodHRwOi8vY3JsMy5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLXRzLmNybDAy
# oDCgLoYsaHR0cDovL2NybDQuZGlnaWNlcnQuY29tL3NoYTItYXNzdXJlZC10cy5j
# cmwwgYUGCCsGAQUFBwEBBHkwdzAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGln
# aWNlcnQuY29tME8GCCsGAQUFBzAChkNodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5j
# b20vRGlnaUNlcnRTSEEyQXNzdXJlZElEVGltZXN0YW1waW5nQ0EuY3J0MA0GCSqG
# SIb3DQEBCwUAA4IBAQBIHNy16ZojvOca5yAOjmdG/UJyUXQKI0ejq5LSJcRwWb4U
# oOUngaVNFBUZB3nw0QTDhtk7vf5EAmZN7WmkD/a4cM9i6PVRSnh5Nnont/PnUp+T
# p+1DnnvntN1BIon7h6JGA0789P63ZHdjXyNSaYOC+hpT7ZDMjaEXcw3082U5cEvz
# nNZ6e9oMvD0y0BvL9WH8dQgAdryBDvjA4VzPxBFy5xtkSdgimnUVQvUtMjiB2vRg
# orq0Uvtc4GEkJU+y38kpqHNDUdq9Y9YfW5v3LhtPEx33Sg1xfpe39D+E68Hjo0mh
# +s6nv1bPull2YYlffqe0jmd4+TaY4cso2luHpoovMIIFMTCCBBmgAwIBAgIQCqEl
# 1tYyG35B5AXaNpfCFTANBgkqhkiG9w0BAQsFADBlMQswCQYDVQQGEwJVUzEVMBMG
# A1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSQw
# IgYDVQQDExtEaWdpQ2VydCBBc3N1cmVkIElEIFJvb3QgQ0EwHhcNMTYwMTA3MTIw
# MDAwWhcNMzEwMTA3MTIwMDAwWjByMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGln
# aUNlcnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMTEwLwYDVQQDEyhE
# aWdpQ2VydCBTSEEyIEFzc3VyZWQgSUQgVGltZXN0YW1waW5nIENBMIIBIjANBgkq
# hkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvdAy7kvNj3/dqbqCmcU5VChXtiNKxA4H
# RTNREH3Q+X1NaH7ntqD0jbOI5Je/YyGQmL8TvFfTw+F+CNZqFAA49y4eO+7MpvYy
# Wf5fZT/gm+vjRkcGGlV+Cyd+wKL1oODeIj8O/36V+/OjuiI+GKwR5PCZA207hXwJ
# 0+5dyJoLVOOoCXFr4M8iEA91z3FyTgqt30A6XLdR4aF5FMZNJCMwXbzsPGBqrC8H
# zP3w6kfZiFBe/WZuVmEnKYmEUeaC50ZQ/ZQqLKfkdT66mA+Ef58xFNat1fJky3se
# BdCEGXIX8RcG7z3N1k3vBkL9olMqT4UdxB08r8/arBD13ays6Vb/kwIDAQABo4IB
# zjCCAcowHQYDVR0OBBYEFPS24SAd/imu0uRhpbKiJbLIFzVuMB8GA1UdIwQYMBaA
# FEXroq/0ksuCMS1Ri6enIZ3zbcgPMBIGA1UdEwEB/wQIMAYBAf8CAQAwDgYDVR0P
# AQH/BAQDAgGGMBMGA1UdJQQMMAoGCCsGAQUFBwMIMHkGCCsGAQUFBwEBBG0wazAk
# BggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAC
# hjdodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURS
# b290Q0EuY3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsNC5kaWdpY2Vy
# dC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8v
# Y3JsMy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMFAG
# A1UdIARJMEcwOAYKYIZIAYb9bAACBDAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3
# dy5kaWdpY2VydC5jb20vQ1BTMAsGCWCGSAGG/WwHATANBgkqhkiG9w0BAQsFAAOC
# AQEAcZUS6VGHVmnN793afKpjerN4zwY3QITvS4S/ys8DAv3Fp8MOIEIsr3fzKx8M
# IVoqtwU0HWqumfgnoma/Capg33akOpMP+LLR2HwZYuhegiUexLoceywh4tZbLBQ1
# QwRostt1AuByx5jWPGTlH0gQGF+JOGFNYkYkh2OMkVIsrymJ5Xgf1gsUpYDXEkdw
# s3XVk4WTfraSZ/tTYYmo9WuWwPRYaQ18yAGxuSh1t5ljhSKMYcp5lH5Z/IwP42+1
# ASa2bKXuh1Eh5Fhgm7oMLSttosR+u8QlK0cCCHxJrhO24XxCQijGGFbPQTS2Zl22
# dHv1VjMiLyI2skuiSpXY9aaOUjGCBBIwggQOAgEBMD0wKTEnMCUGCSqGSIb3DQEJ
# ARYYY2hyaXMuY2FtcGJlbGxAbGludXguY29tAhBH0zs4WyuVtklHptPJiiNQMAkG
# BSsOAwIaBQCgeDAYBgorBgEEAYI3AgEMMQowCKACgAChAoAAMBkGCSqGSIb3DQEJ
# AzEMBgorBgEEAYI3AgEEMBwGCisGAQQBgjcCAQsxDjAMBgorBgEEAYI3AgEVMCMG
# CSqGSIb3DQEJBDEWBBT9rri6cNQrQHUEwoPQMndFUajkNzANBgkqhkiG9w0BAQEF
# AASCAQCnfEmOAk0L6Y4RK6A3ejzrkEvOvU8XHdYje36oDYdf8GOfQa+Xd89p031E
# yZEhVR2RBs+E/fo1i6lqQguLhDfq3pDvQmJlBK6ulwTWZi+8kA3BZrdU2ASZbRCZ
# hKDHC0oAmtOApENVvpOOz+wupidJPGoWlrq4ymmjkM5nftMa1sXp6SmwmXzi9EKu
# f6dNF9nL5NsnqCGNxhZtZK8bAEMmxlK+Tn22q6Csu/cuqOKx2IyG66LksjC1SrwA
# Ia5EpJlTM5h/GdQD3wRapmvdcnC5H6TUVHiA/yIjcBZF3nusZPTEaRLZy1PQ2vqu
# kngDAihckH6bYZhRooA9gWxR8+T8oYICMDCCAiwGCSqGSIb3DQEJBjGCAh0wggIZ
# AgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxGTAX
# BgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNIQTIg
# QXNzdXJlZCBJRCBUaW1lc3RhbXBpbmcgQ0ECEA1CSuC+Ooj/YEAhzhQA8N0wDQYJ
# YIZIAWUDBAIBBQCgaTAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3
# DQEJBTEPFw0yMTA4MzAyMzA4MzlaMC8GCSqGSIb3DQEJBDEiBCAfXpuhobbnJFM8
# GFY6rbfnL/Bd9meYRW1Ktk4ahoKCtDANBgkqhkiG9w0BAQEFAASCAQAf29ugT4SM
# iKbBMqOl96vX6vCSTkdmw2K+fytxbEEo5j42+APWgsVK6BUYpcwOeBXM7YdUw84s
# Wsk3rUuWgClGYQpU5lDm+RvFtmXOtyBizUt/V3+si+TH6zSodKQjCOQ4fd5Uh8i2
# rdf39oMCgky3uxjO5zeJibYkIpCIg+FU6HE+BZrsFYmM6M7Z3z+aVT82QRep57CZ
# /IeEvba6+i+1enYO+G/nuYLld9tu/eBMo9MqczgE8vYAw3oqlYvilkQzQYO5oEAm
# iakAJ+xf0NWV5/7kkBEpy4DsxMPhP8IzHwYD6v/1KdWDDfrGz+7q8sFlqstpu6g3
# oNmSP6cNPYr2
# SIG # End signature block
